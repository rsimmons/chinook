(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=null,a=function(){function e(e,t,n){void 0===n&&(n=null),this.streamFunc=e,this.onRequestUpdate=t,this.afterTerminate=n,this.hookRecordChain={data:null,cleanup:null,next:null},this.recordCursor=null,this.openRecord=null,this.updateCount=0}return e.prototype.update=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n;r={executionContext:this,previousFrame:r},this.recordCursor=this.hookRecordChain;try{if(n=this.streamFunc.apply(null,arguments),this.recordCursor.next)throw new Error("Did not reach all hook records in update")}finally{var a=r;if(!a)throw new Error("Cannot pop update frame because current is null");if(a.executionContext!==this)throw new Error("Popped frame from update stack but context did not match");r=a.previousFrame}return this.updateCount++,n},e.prototype.terminate=function(){for(var e=this.hookRecordChain.next;e;e=e.next)e.cleanup&&e.cleanup();this.afterTerminate&&this.afterTerminate()},e.prototype._beginHook=function(){if(this.openRecord)throw new Error("This is already an open hook when beginning another");if(!this.recordCursor)throw new Error;if(0===this.updateCount){if(this.recordCursor.next)throw new Error("Expecting to create new hook record in chain, but already present");this.recordCursor.next={data:null,cleanup:null,next:null}}if(!this.recordCursor.next)throw new Error("Expecting to find hook record in chain, but not present");return this.openRecord=this.recordCursor.next,this.recordCursor.next},e.prototype._endHook=function(){if(!this.recordCursor)throw new Error;if(this.openRecord!==this.recordCursor.next)throw new Error("Hook close does not match open");this.openRecord=null,this.recordCursor=this.recordCursor.next},e.prototype._requestUpdate=function(){this.onRequestUpdate()},e.prototype._setStreamFunc=function(e){this.streamFunc=e},e}();t.ExecutionContext=a;var i=null;function o(e){i?i.callbacks.add(e):e()}function u(){if(!r)throw new Error("Cannot get currently updating execution context because update stack is empty. Was a hook called outside of an execution context update?");return r.executionContext}function c(e){var t=u(),n=t._beginHook();if(!n.data){var r=e instanceof Function?e():e;n.data={current:r}}return t._endHook(),n.data}function l(){var e=u(),t=e._beginHook();return t.data||(t.data={requestUpdate:function(){e._requestUpdate()}}),e._endHook(),t.data.requestUpdate}function s(e){var t,n=u(),r=n._beginHook();if(!r.data){var a=[],i={queue:a,lastStream:null,unsubscribe:null,onValue:function(e){a.push(e)}};r.data=i,r.cleanup=function(){i.unsubscribe&&i.unsubscribe()}}var o=r.data;if(e!==o.lastStream){if(o.queue.length)throw new Error("useEventReceiver stream changed, but value is in queue");if(o.lastStream){if(!o.unsubscribe)throw new Error("should not be possible");o.unsubscribe(),o.lastStream=null,o.unsubscribe=null}o.lastStream=e,e&&(o.unsubscribe=e.subscribe(o.onValue))}else if(o.queue.length){if(o.queue.length>1)throw new Error("useEventReceiver found more than one enqueued value");t={value:o.queue.pop()}}return n._endHook(),t}t.beginBatch=function(){if(i)throw new Error("cannot begin batch when one is already active");i={callbacks:new Set}},t.endBatch=function(){if(!i)throw new Error("cannot end batch when none is active");i.callbacks.forEach(function(e){e()}),i=null},t.enqueueBatchedUpdate=o,t.createNullaryVoidRootExecutionContext=function(e){var t=0,n=function(){var e=performance.now();r.update();var n=performance.now()-e;t++,console.log("root update","count",t,"time",n.toFixed(2)+"ms")},r=new a(e,function(){o(n)});return r},t.useVar=c,t.useRequestUpdate=l,t.useInitialize=function(e){var t=u(),n=t._beginHook();n.data||(n.cleanup=e()||null,n.data={}),t._endHook()},t.useEventEmitter=function(){var e=u(),t=e._beginHook();if(!t.data){var n=new Set,r={subscribe:function(e){return n.add(e),function(){n.delete(e)}}};t.data={stream:r,emit:function(e){n.forEach(function(t){t(e)})}}}return e._endHook(),[t.data.stream,t.data.emit]},t.useEventReceiver=s,t.useDynamic=function(e,t){var n=u(),r=n._beginHook();if(!r.data){var i=t||function(){n._requestUpdate()},o={activeContexts:new Set,createContext:function(){var e=new a(o.streamFunc,i,function(){o.activeContexts.delete(e)});return o.activeContexts.add(e),e},streamFunc:function(){throw new Error("should be unreachable")}};r.data=o,r.cleanup=function(){o.activeContexts.forEach(function(e){return e.terminate()})}}return r.data.streamFunc=e,r.data.activeContexts.forEach(function(t){t._setStreamFunc(e)}),n._endHook(),r.data.createContext},t.useReducer=function(e,t,n){var r=c(n),a=s(e);return a&&(r.current=t(r.current,a.value)),r.current},t.useReducers=function(e,t){var n=c(t),r=c(e.length);if(e.length!==r.current)throw new Error("The number of streams/reducers supplied to useMultiReducer cannot change");for(var a=0,i=0,o=e;i<o.length;i++){var u=o[i],l=u[0],d=u[1],f=s(l);if(f){if(a>0)throw new Error("useMultiReducer got multiple events, cannot merge");n.current=d(n.current,f.value),a++}}return n.current},t.useCallbackReducer=function(e,t){var n=l(),r=c(t),a=c(function(){return function(t){r.current=e(r.current,t),n()}});return[r.current,a.current]},t.useCallbackReducers=function(e,t){var n=l(),r=c(t),a=e.map(function(e){return function(t){r.current=e(r.current,t),n()}});return[r.current,a]},t.useMachine=function(e,t){var n,r=u(),i=r._beginHook(),o=function(t){i.data.activeContext&&i.data.activeContext.terminate();var n=t[0],o=t[1],u=new a(e[n],function(){r._requestUpdate()});i.data.activeState=n,i.data.activeContext=u,i.data.activeArgument=o};if(!i.data){var c={activeContext:null};i.data=c,o(t),i.cleanup=function(){if(!c.activeContext)throw new Error("should have been initialized");c.activeContext.terminate()}}for(;;){i.data.activeContext._setStreamFunc(e[i.data.activeState]);var l=i.data.activeContext.update(i.data.activeArgument),s=l[0],d=l[1];if(n=s,!d)break;o(d)}return r._endHook(),n}},,,,,,,,,,,function(e,t,n){e.exports=n(41)},,,,,,function(e,t,n){},function(e,t,n){},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"showString",function(){return h}),n.d(t,"animationFrameEvts",function(){return E}),n.d(t,"latestValue",function(){return g}),n.d(t,"animationTime",function(){return b}),n.d(t,"countEvents",function(){return y}),n.d(t,"mouseClickEvts",function(){return x}),n.d(t,"mouseDown",function(){return O}),n.d(t,"mousePosition",function(){return S}),n.d(t,"random",function(){return I}),n.d(t,"audioDriver",function(){return j}),n.d(t,"sampleUpon",function(){return N}),n.d(t,"everySecond",function(){return T}),n.d(t,"loadAudioAsArray",function(){return k}),n.d(t,"integral",function(){return C}),n.d(t,"expFollow",function(){return _}),n.d(t,"redCircle",function(){return A}),n.d(t,"followAtSpeed2d",function(){return D}),n.d(t,"eventAfter",function(){return R}),n.d(t,"received",function(){return P}),n.d(t,"streamMap",function(){return M}),n.d(t,"changeCount",function(){return U});n(4);var r=n(1),a=n(5),i=a.useVar,o=a.useRequestUpdate,u=a.useInitialize,c=a.useEventEmitter,l=a.useEventReceiver,s=a.useDynamic,d=a.useReducer,f=a.useReducers,m=n(28),p=m.renderDOMAppendedToBody,v=m.h;function h(e){var t=v("div",{style:{border:"1px solid red",color:"black",fontSize:"24px",padding:"5px",marginTop:"20px"}},"showString: "+(void 0===e?"(undefined)":e.toString()));p(t)}function E(){var e=o(),t=i(),n=c(),a=Object(r.a)(n,2),l=a[0],s=a[1];return u(function(){return t.current=requestAnimationFrame(function n(r){s(.001*r),e(),t.current=requestAnimationFrame(n)}),function(){cancelAnimationFrame(t.current)}}),l}function g(e,t){return d(e,function(e,t){return t},t)}function b(){return g(E(),function(){return.001*performance.now()})}function y(e){return d(e,function(e){return e+1},0)}function w(e,t,n){var a=o(),i=c(),l=Object(r.a)(i,2),s=l[0],d=l[1];return u(function(){var e=function(e){d(e),a()};return document.addEventListener(t,e,n),function(){document.removeEventListener(t,e,n)}}),s}function x(){return w(document,"mousedown")}function O(){var e=w(document,"mousedown"),t=w(document,"mouseup");return f([[t,function(){return!1}],[e,function(){return!0}]],!1)}function S(){return g(function(e){var t=l(e),n=c(),a=Object(r.a)(n,2),i=a[0],o=a[1];return t&&o(t.value),i}(w(document,"mousemove")),{x:0,y:0})}function I(e){return d(e,function(){return Math.random()},function(){return Math.random()})}function j(e){var t=s(e),n=i(),a=i(0),o=i(),l=c(),d=Object(r.a)(l,2),f=d[0],m=d[1];u(function(){n.current=t();var e=new(window.AudioContext||window.webkitAudioContext),r=e.createScriptProcessor(1024,0,1);return r.onaudioprocess=function(e){for(var t=e.outputBuffer.getChannelData(0),r=0;r<t.length;r++){m();var i=n.current.update(a.current/o.current,f,o.current);!i||Number.isNaN(i)?i=0:i>1?i=1:i<-1&&(i=-1),t[r]=i,a.current++}},r.connect(e.destination),o.current=e.sampleRate,function(){r.disconnect(),e.close()}}),n.current.update(a.current/o.current,f,o.current)}function N(e,t,n){return d(t,function(){return e},n)}function T(){var e=o(),t=c(),n=Object(r.a)(t,2),a=n[0],i=n[1];return u(function(){var t=setInterval(function(){i(),e()},1e3);return function(){clearInterval(t)}}),a}function k(e){var t=o(),n=i([0]);return u(function(){var r=new(window.AudioContext||window.webkitAudioContext),a=!1,i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){var e=i.response;r.decodeAudioData(e,function(e){a||(n.current=e.getChannelData(0),t())})},i.send(),function(){i.abort(),a=!0}}),n.current}function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=i(n),a=i(t),o=e(r.current,a.current);return r.current+=(t-a.current)*o,a.current=t,r.current}function _(e,t,n,r){return C(function(n){return t*(e-n)},n,r)}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25,n=e||{x:0,y:0};t<0&&(t=0);var r=.5*t,a=v("div",{style:{position:"absolute",borderRadius:"50%",background:"red",pointerEvents:"none",userSelect:"none",left:n.x-r+"px",top:n.y-r+"px",width:t+"px",height:t+"px"}});p(a)}function D(e,t,n,r){var a=i(r),o=i(n),u=n-o.current,c=e.x-a.current.x,l=e.y-a.current.y,s=Math.sqrt(c*c+l*l);return a.current=t*u>=s?e:{x:a.current.x+u*t*c/s,y:a.current.y+u*t*l/s},o.current=n,a.current}function R(e,t){var n=c(),a=Object(r.a)(n,2),o=a[0],l=a[1],s=i(t);return s.current=t,u(function(){var t=setTimeout(function(){l(s.current)},1e3*e);return function(){clearTimeout(t)}}),o}function P(e){return d(e,function(e,t){return!0},!1)}function M(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=s(e),r=i([]);t.length>r.current.length;)r.current.push(n());for(;t.length<r.current.length;){r.current.pop().terminate()}return r.current.map(function(e,n){return e.update(t[n])})}function U(e){var t,n,r=i(0),a=i(e);return t=e,n=a.current,Number.isNaN(t)&&Number.isNaN(n)||t===n||r.current++,a.current=e,r.current}},function(e,t,n){"use strict";n.r(t),n.d(t,"h",function(){return i}),n.d(t,"renderDOMIntoElement",function(){return u}),n.d(t,"renderDOMIntoSelector",function(){return c}),n.d(t,"renderDOMAppendedToBody",function(){return l});var r=n(5),a=n(42).init([n(29).default,n(30).default,n(31).default,n(32).default]),i=n(33).default;function o(e){return{sel:e.sel,data:e.data,children:e.children&&e.children.map(o),text:e.text,key:e.key,elm:e.elm}}function u(e,t){var n=Object(r.useVar)(t),i=Object(r.useVar)(),u=o(e);if(Object(r.useInitialize)(function(){return function(){n.current.innerHTML=""}}),i.current)a(i.current,u);else{var c=document.createElement("div");n.current.appendChild(c),a(c,u)}i.current=u}function c(e,t){u(e,Object(r.useVar)(function(){return document.querySelector(t)}).current)}function l(e){var t=Object(r.useVar)();Object(r.useInitialize)(function(){var e=document.createElement("div");return document.body.appendChild(e),t.current=e,function(){document.body.removeChild(e)}}),u(e,t.current)}},,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(11),o=n.n(i),u=(n(22),n(23),n(4)),c=n(1),l=n(9),s=n(2);function d(e){return"Identifier"===e.type}function f(e){return"ArrayLiteral"===e.type}function m(e){return"Application"===e.type}function p(e){return"Parameter"===e.type}function v(e){return function(e){return"UndefinedExpression"===e.type}(e)||function(e){return"IntegerLiteral"===e.type}(e)||f(e)||function(e){return"StreamReference"===e.type}(e)||m(e)||p(e)}function h(e){return"UserFunction"===e.type}function E(e){return function(e){return"NativeFunction"===e.type}(e)||h(e)}function g(e,t){if(e.length>t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var b=function(){return Math.random().toString(16).substring(2,10)},y=function(){return b()+b()},w=n(7),x=n(14),O=n(8),S=n(12),I=n(15),j=n(13),N=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;Object(w.a)(this,e),this.obj=void 0,this.obj=Object.create(t?t.obj:null)}return Object(j.a)(e,[{key:"get",value:function(e){return this.obj[e]}},{key:"set",value:function(e,t){this.obj[e]=t}},{key:"delete",value:function(e){delete this.obj[e]}}]),e}();function T(e,t,n){var r=function e(t,n,r,a){if(r.alongPath&&!g(n,r.alongPath))return[!1,t];var i=!1,o=t;if((v(o)||E(o))&&o.identifier){var u=e(o.identifier,n.concat(["identifier"]),r,a),l=Object(c.a)(u,2),d=l[0],f=l[1];d&&(i=!0),f!==o.identifier&&(o=Object(s.a)({},o,{identifier:f}))}switch(o.type){case"Program":var m=e(o.mainDefinition,n.concat(["mainDefinition"]),r,a),p=Object(c.a)(m,2),h=p[0],b=p[1];h&&(i=!0),b!==o.mainDefinition&&(o=Object(s.a)({},o,{mainDefinition:b}));break;case"UserFunction":var y=[],w=[],x=!1;o.parameters.forEach(function(t,o){if(i)y.push(t);else{var u=e(t,n.concat(["parameters",o]),r,a),l=Object(c.a)(u,2),s=l[0],d=l[1];s&&(i=!0),y.push(d),d!==t&&(x=!0)}}),o.expressions.forEach(function(t,o){if(i)w.push(t);else{var u=e(t,n.concat(["expressions",o]),r,a),l=Object(c.a)(u,2),s=l[0],d=l[1];s&&(i=!0),w.push(d),d!==t&&(x=!0)}}),x&&(o=Object(s.a)({},o,{parameters:y,expressions:w}));break;case"Application":var O=[],S=[],I=!1;o.arguments.forEach(function(t,o){if(i)O.push(t);else{var u=e(t,n.concat(["arguments",o]),r,a),l=Object(c.a)(u,2),s=l[0],d=l[1];s&&(i=!0),O.push(d),d!==t&&(I=!0)}}),o.functionArguments.forEach(function(t,o){if(i||r.onlyLocal)S.push(t);else{var u=e(t,n.concat(["functionArguments",o]),r,a),l=Object(c.a)(u,2),s=l[0],d=l[1];s&&(i=!0),S.push(d),d!==t&&(I=!0)}}),I&&(o=Object(s.a)({},o,{arguments:O,functionArguments:S}));break;case"ArrayLiteral":var j=[],N=!1;o.items.forEach(function(t,o){if(i)j.push(t);else{var u=e(t,n.concat(["items",o]),r,a),l=Object(c.a)(u,2),s=l[0],d=l[1];s&&(i=!0),j.push(d),d!==t&&(N=!0)}}),N&&(o=Object(s.a)({},o,{items:j}));break;case"Identifier":case"IntegerLiteral":case"StreamReference":case"UndefinedExpression":case"Parameter":break;default:throw new Error}return i?[i,o]:a(o,n)}(e,[],t,n);return Object(c.a)(r,2)[1]}var k=function(e){function t(){return Object(w.a)(this,t),Object(x.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(S.a)(t,e),t}(Object(I.a)(Error));function C(e,t){var n=t.streamEnvironment,r=t.functionEnvironment,a=t.localStreamIds,i=t.temporaryMarkedStreamIds,o=t.permanentMarkedStreamIds,u=t.compiledDefinition;if(!o.has(e.streamId)){if(i.has(e.streamId))throw new k("graph cycle");switch(e.type){case"Parameter":break;case"UndefinedExpression":u.literalStreamValues.push([e.streamId,void 0]);break;case"IntegerLiteral":u.literalStreamValues.push([e.streamId,e.value]);break;case"ArrayLiteral":i.add(e.streamId);var c=!0,l=!1,s=void 0;try{for(var d,f=e.items[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){C(d.value,t)}}catch(N){l=!0,s=N}finally{try{c||null==f.return||f.return()}finally{if(l)throw s}}i.delete(e.streamId),u.applications.push([e.streamId,"Array_of",e.items.map(function(e){return e.streamId}),[]]);break;case"StreamReference":if(a.has(e.targetStreamId)){var m=n.get(e.targetStreamId);if(!m)throw Error();i.add(e.streamId),C(m,t),i.delete(e.streamId)}else{if(void 0===n.get(e.targetStreamId))throw new Error;u.externalReferencedStreamIds.add(e.targetStreamId)}u.applications.push([e.streamId,"id",[e.targetStreamId],[]]);break;case"Application":var p=r.get(e.functionId);if(!p)throw Error();i.add(e.streamId);var v=!0,h=!1,E=void 0;try{for(var g,b=e.arguments[Symbol.iterator]();!(v=(g=b.next()).done);v=!0){C(g.value,t)}}catch(N){h=!0,E=N}finally{try{v||null==b.return||b.return()}finally{if(h)throw E}}var y=!0,w=!1,x=void 0;try{for(var O,S=e.functionArguments[Symbol.iterator]();!(y=(O=S.next()).done);y=!0){var I=O.value,j=_(I,n,r);j.externalReferencedStreamIds.forEach(function(e){u.externalReferencedStreamIds.add(e)}),j.externalReferencedStreamIds.forEach(function(e){if(a.has(e)){var r=n.get(e);if(void 0===r)throw new Error;C(r,t)}}),u.containedDefinitions.push([I.functionId,j])}}catch(N){w=!0,x=N}finally{try{y||null==S.return||S.return()}finally{if(w)throw x}}i.delete(e.streamId),u.applications.push([e.streamId,p.functionId,e.arguments.map(function(e){return e.streamId}),e.functionArguments.map(function(e){return e.functionId})]);break;default:throw new Error}o.add(e.streamId)}}function _(e,t,n){var r=new N(t),a=new N(n),i=new Set,o=new Set;T(e,{onlyLocal:!0},function(e){if(v(e)||p(e)){if(void 0!==r.get(e.streamId))throw new Error("must be unique");r.set(e.streamId,e),i.add(e.streamId)}if(h(e)){if(void 0!==a.get(e.functionId))throw new Error("must be unique");a.set(e.functionId,e),o.add(e.functionId)}return[!1,e]});var u=new Set,c=new Set,l={parameterStreams:e.parameters.map(function(e){return e.streamId}),literalStreamValues:[],applications:[],containedDefinitions:[],yieldStream:null,externalReferencedStreamIds:new Set},s=!0,d=!1,f=void 0;try{for(var m,E=e.expressions[Symbol.iterator]();!(s=(m=E.next()).done);s=!0){var g=m.value;C(g,{streamEnvironment:r,functionEnvironment:a,localStreamIds:i,localFunctionIds:o,temporaryMarkedStreamIds:u,permanentMarkedStreamIds:c,compiledDefinition:l}),l.yieldStream=g.streamId}}catch(b){d=!0,f=b}finally{try{s||null==E.return||E.return()}finally{if(d)throw f}}return l}var A=n(5);var D=n(27),R=D.showString,P=D.animationTime,M=D.mouseDown,U=D.changeCount,L=D.streamMap,F=D.audioDriver,V=D.random,q=D.mouseClickEvts,G=D.redCircle,H=D.mousePosition,B=D.latestValue;var W=[["add","add",["_a","_b"],[],function(e,t){return e+t}],["sub","subtract",["_a","_b"],[],function(e,t){return e-t}],["mult","multiply",["_a","_b"],[],function(e,t){return e*t}],["div","divide",["_a","_b"],[],function(e,t){return e/t}],["showString","show value",["_v"],[],R],["animationTime","animation time",[],[],P],["mouseDown","is mouse down",[],[],M],["changeCount","change count",["_stream"],[],U],["streamMap","map",["_array"],[["_func",{parameters:["value"],functionParameters:[]}]],function(e,t){return L(t,e)}],["ifte","if",["cond","then","else"],[],function(e,t,n){return e?t:n}],["audioDriver","play computed audio",[],[["_func",{parameters:["audio time","next frame","sample rate"],functionParameters:[]}]],F],["cos","cosine",["_v"],[],Math.cos],["random","random",["repick"],[],V],["mouseClickEvts","mouse click",[],[],q],["redCircle","draw red circle",["position","radius"],[],G],["mousePosition","mouse position",[],[],H],["latestValue","latest event value",["event stream","initial value"],[],B],["vec2zero","zero 2d vector",[],[],function(){return{x:0,y:0}}],["vec2add","add 2d vectors",["_a","_b"],[],function(e,t){return{x:e.x+t.x,y:e.y+t.y}}],["vec2sub","subtract 2d vectors",["_a","_b"],[],function(e,t){return{x:e.x-t.x,y:e.y-t.y}}],["vec2len","length of 2d vector",["_v"],[],function(e){return Math.sqrt(e.x*e.x+e.y*e.y)}],["vec2sqgrid","square grid of 2d vectors",["count","size"],[],function(e,t){for(var n=t/e,r=[],a=0;a<e;a++)for(var i=0;i<e;i++)r.push({x:i*n,y:a*n});return r}]],z={Expression:["UndefinedExpression","IntegerLiteral","ArrayLiteral","StreamReference","Application","Parameter"],Any:["Program","Identifier","UndefinedExpression","IntegerLiteral","ArrayLiteral","StreamReference","Application","NativeFunction","UserFunction"]};function J(e,t){var n=e,r=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){n=n[o.value]}}catch(c){a=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}function K(e,t,n){var r=t,a=0,i=!0,o=!1,u=void 0;try{for(var c,l=n[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var s=c.value;if(e===r)return[n.slice(0,a),n.slice(a)];r=r[s],a++}}catch(d){o=!0,u=d}finally{try{i||null==l.return||l.return()}finally{if(o)throw u}}if(e===r)return[n.slice(0,a),n.slice(a)];throw new Error("node was not in path")}function Z(e,t,n){T(e,{onlyLocal:!0},function(e,r){return v(e)&&e.identifier&&t.push([e.identifier.name,e]),h(e)&&e.identifier&&n.push([e.identifier.name,e]),[!1,e]})}function X(e){var t=[],n=[],r=!0,a=!1,i=void 0;try{for(var o,u=e.nativeFunctions[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var c=o.value;c.identifier&&n.push([c.identifier.name,c])}}catch(l){a=!0,i=l}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return function(e,t,n,r){var a=e,i=!0,o=!1,u=void 0;try{for(var c,s=t[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var d=c.value;"UserFunction"===a.type&&Z(a,n,r),a=a[d]}}catch(l){o=!0,u=l}finally{try{i||null==s.return||s.return()}finally{if(o)throw u}}}(e.program,e.selectionPath,t,n),{namedStreams:t,namedFunctions:n}}var Y=function(e,t){return JSON.stringify(e)===JSON.stringify(t)};function $(e,t){if("number"!==typeof t)throw new Error;var n=Object(s.a)({},e,{expressions:[].concat(Object(u.a)(e.expressions.slice(0,t)),Object(u.a)(e.expressions.slice(t+1)))});if(n.expressions.length){var r=t-1;return r=Math.max(r,0),[n,["expressions",r=Math.min(r,e.expressions.length-1)],null]}var a={type:"UndefinedExpression",streamId:y(),identifier:null};return n.expressions.push(a),[n,["expressions",0],{originalNode:a,tentativeNode:a}]}function Q(e,t){var n=e.node,r=e.subpath,a=e.editingSelected;if(!a)throw new Error;if(!d(n)){if(0!==r.length){if(!v(n)||!Y(r,["identifier"]))throw new Error;if(!n.identifier)throw new Error;var i,o=(i=t?n.identifier.name.trim():a.originalNode.name)?{type:"Identifier",name:i}:null;return[Object(s.a)({},n,{identifier:o}),[],null]}var u=t?a.tentativeNode:a.originalNode,l=r,f=null;if(t){var m=ee(u);if(m){var p=Object(c.a)(m,2),h=p[0],E=p[1];h!==u&&(l=E,f={originalNode:h,tentativeNode:h})}}return[u,l,f]}}function ee(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=!1;return T(e,{},function(e,a){return n&&g(n,a)&&(r=!0),"UndefinedExpression"!==e.type||!r&&n?[!1,e]:(t=[e,a],[!0,e])}),t}var te=[["Program",["SET_PROGRAM_NAME"],function(e){var t=e.node,n=e.subpath,r=e.editingSelected,a=e.action;return[Object(s.a)({},t,{name:a.newName||""}),n,r]}],["UserFunction",["MOVE_UP","MOVE_DOWN"],function(e){var t=e.node,n=e.subpath,r=e.action;if(!h(t))throw new Error;if(2===n.length&&"expressions"===n[0])return[t,["expressions",function(){var e=n[1];if("number"!==typeof e)throw new Error;var a=e+("MOVE_UP"===r.type?-1:1);return a=Math.max(a,0),a=Math.min(a,t.expressions.length-1)}()],null]}],["UserFunction",["DELETE"],function(e){var t=e.node,n=e.subpath;if(!h(t))throw new Error;if(2===n.length&&"expressions"===n[0]){var r=n[1];if("number"!==typeof r)throw new Error;return $(t,r)}}],["UserFunction",["ZOOM_IN","MOVE_RIGHT"],function(e){var t=e.node,n=e.subpath;if(!h(t))throw new Error;if(0===n.length)return[t,["expressions",0],null]}],["Any",["SET_NODE"],function(e){return[e.action.newNode,[],null]}],["Any",["TOGGLE_EDIT"],function(e){var t=e.node,n=e.subpath;if(e.editingSelected)return Q(e,!0);if(0!==n.length)throw new Error;switch(t.type){case"IntegerLiteral":case"UndefinedExpression":case"StreamReference":case"Application":return[t,n,{originalNode:t,tentativeNode:t}];case"ArrayLiteral":break;default:throw new Error}}],["Any",["ABORT_EDIT"],function(e){if(e.editingSelected)return Q(e,!1)}],["Any",["CONFIRM_EDIT"],function(e){if(e.editingSelected)return Q(e,!0)}],["Expression",["BEGIN_IDENTIFIER_EDIT"],function(e){var t=e.node,n=e.subpath;if(!v(t))throw new Error;if(Y(n,[])){var r=t.identifier||{type:"Identifier",name:""};return[Object(s.a)({},t,{identifier:r}),["identifier"],{originalNode:r,tentativeNode:r}]}}],["Expression",["BEGIN_OVERWRITE_EDIT"],function(e){var t=e.node,n=e.subpath;if(!v(t))throw new Error;return[t,n,{originalNode:t,tentativeNode:{type:"UndefinedExpression",streamId:t.streamId,identifier:t.identifier}}]}],["Any",["UPDATE_EDITING_TENTATIVE_NODE"],function(e){var t=e.node,n=e.subpath,r=e.action,a=e.editingSelected;if(!r.newNode)throw new Error;if(!a)throw new Error;if(0===n.length){var i;if(d(t))i=r.newNode;else{if(!v(t))throw new Error;i=t}return[i,n,Object(s.a)({},a,{tentativeNode:r.newNode})]}}],["UserFunction",["EDIT_AFTER"],function(e){var t=e.node,n=e.subpath;if(!h(t))throw new Error;if(n.length>=2&&"expressions"===n[0]){var r=n[1];if("number"!==typeof r)throw new Error;var a={type:"UndefinedExpression",streamId:y(),identifier:null};return[Object(s.a)({},t,{expressions:[].concat(Object(u.a)(t.expressions.slice(0,r+1)),[a],Object(u.a)(t.expressions.slice(r+1)))}),["expressions",r+1],{originalNode:a,tentativeNode:a}]}}],["ArrayLiteral",["ZOOM_OUT","MOVE_LEFT"],function(e){var t=e.node,n=e.subpath;if(2===n.length){if("items"!==n[0]||"number"!==typeof n[1])throw Error();return[t,[],null]}}],["ArrayLiteral",["ZOOM_IN","MOVE_RIGHT"],function(e){var t=e.node,n=e.subpath;if(!f(t))throw new Error;if(0===n.length){if(0===t.items.length){var r={type:"UndefinedExpression",streamId:y(),identifier:null};return[Object(s.a)({},t,{items:[r]}),["items",0],{originalNode:r,tentativeNode:r}]}return[t,["items",0],null]}}],["ArrayLiteral",["MOVE_UP","MOVE_DOWN"],function(e){var t=e.node,n=e.subpath,r=e.action;if(!f(t))throw new Error;if(2===n.length&&"items"===n[0]){var a=n[1];if("number"!==typeof a)throw new Error;var i=a+("MOVE_UP"===r.type?-1:1);return i<0||i>=t.items.length?[t,[],null]:[t,["items",i],null]}}],["ArrayLiteral",["EDIT_AFTER"],function(e){var t=e.node,n=e.subpath;if(!f(t))throw new Error;if(2===n.length&&"items"===n[0]){var r=n[1];if("number"!==typeof r)throw new Error;var a={type:"UndefinedExpression",streamId:y(),identifier:null};return[Object(s.a)({},t,{items:[].concat(Object(u.a)(t.items.slice(0,r+1)),[a],Object(u.a)(t.items.slice(r+1)))}),["items",r+1],{originalNode:a,tentativeNode:a}]}}],["ArrayLiteral",["DELETE"],function(e){var t=e.node,n=e.subpath;if(!f(t))throw new Error;if(2===n.length){if(0===t.items.length)throw new Error;var r=n[1];if("number"!==typeof r)throw new Error;var a=Object(s.a)({},t,{items:[].concat(Object(u.a)(t.items.slice(0,r)),Object(u.a)(t.items.slice(r+1)))});if(a.items.length>0){var i=r-1;return i=Math.max(i,0),[a,["items",i=Math.min(i,t.items.length-1)],null]}return[a,[],null]}}],["Expression",["CREATE_ARRAY"],function(e){var t=e.node,n=e.subpath;if(!v(t))throw new Error;if(0===n.length){var r={type:"UndefinedExpression",streamId:y(),identifier:null};return[{type:"ArrayLiteral",streamId:t.streamId,identifier:t.identifier,items:[r]},["items",0],{originalNode:r,tentativeNode:r}]}}],["UserFunction",["ZOOM_OUT","MOVE_LEFT"],function(e){var t=e.node,n=e.subpath;if(!h(t))throw new Error;if(2===n.length){if("expressions"===n[0]&&"number"===typeof n[1])return[t,[],null];throw new Error}}],["Application",["ZOOM_OUT","MOVE_LEFT"],function(e){var t=e.node,n=e.subpath;if(!m(t))throw new Error;if(2===n.length){if("arguments"===n[0]&&"number"===typeof n[1])return[t,[],null];if("functionArguments"===n[0]&&"number"===typeof n[1])return[t,[],null];throw new Error}}],["Application",["ZOOM_IN","MOVE_RIGHT"],function(e){var t=e.node,n=e.subpath;if(!m(t))throw new Error;if(0===n.length){if(t.arguments.length>0)return[t,["arguments",0],null];if(t.functionArguments.length>0)return[t,["functionArguments",0],null]}}],["Application",["MOVE_UP","MOVE_DOWN"],function(e){var t=e.node,n=e.subpath,r=e.action;if(!m(t))throw new Error;if(2===n.length&&"arguments"===n[0]){var a=n[1];if("number"!==typeof a)throw new Error;var i=a+("MOVE_UP"===r.type?-1:1);return i>=t.arguments.length&&t.functionArguments.length?[t,["functionArguments",0],null]:i<0||i>=t.arguments.length?[t,[],null]:[t,["arguments",i],null]}if(2===n.length&&"functionArguments"===n[0]){var o=n[1];if("number"!==typeof o)throw new Error;var u=o+("MOVE_UP"===r.type?-1:1);return u<0&&t.arguments.length?[t,["arguments",t.arguments.length-1],null]:u<0||u>=t.arguments.length?[t,[],null]:[t,["functionArguments",u],null]}}],["Application",["DELETE"],function(e){var t=e.node,n=e.subpath;e.action;if(!m(t))throw new Error;if(2===n.length&&"arguments"===n[0]){var r=n[1];if("number"!==typeof r)throw new Error;var a=t.arguments.slice();return a[r]={type:"UndefinedExpression",streamId:t.arguments[r].streamId,identifier:t.arguments[r].identifier},[Object(s.a)({},t,{arguments:a}),["arguments",r],null]}}]];function ne(e,t,n,r){var a=!1,i=t,o=n,u=T(e,{alongPath:t},function(u,l){for(var s=0,d=te;s<d.length;s++){var f=d[s],m=Object(c.a)(f,3),p=m[0],v=m[1],h=m[2];if((z[p]?z[p]:[p]).includes(u.type)&&v.includes(r.type)){var E=K(u,e,t),g=Object(c.a)(E,2),b=g[0],y=h({node:u,subpath:g[1],editingSelected:n,action:r});if(y){a=!0;var w=Object(c.a)(y,3),x=w[0],O=w[1],S=w[2];return i=b.concat(O),o=S,[!0,x]}}}return[!1,u]});if("Program"!==u.type)throw new Error;if(!a&&(u!==e||i!==t||o!==n))throw new Error;return[u,i,o]}function re(e){var t=new Map,n=new Map,r=!0,a=!1,i=void 0;try{for(var o,u=e.nativeFunctions[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var c=o.value;n.set(c.functionId,c)}}catch(l){a=!0,i=l}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return T(e.program,{},function(e){if(v(e)||p(e)){if(t.has(e.streamId))throw new Error("stream ids must be unique");t.set(e.streamId,e)}if(h(e)){if(n.has(e.functionId))throw new Error("funciton ids must be unique");n.set(e.functionId,e)}return[!1,e]}),Object(s.a)({},e,{derivedLookups:{streamIdToNode:t,functionIdToNode:n,nodeToPath:null}})}function ae(e){var t=new Map;return T(e,{},function(e,n){return t.set(e,n),[!1,e]}),t}function ie(e,t){var n,r={parameterStreams:[],literalStreamValues:[],applications:[],containedDefinitions:[],yieldStream:null,externalReferencedStreamIds:new Set};try{var a=new N,i=!0,o=!1,l=void 0;try{for(var d,f=t.nativeFunctions[Symbol.iterator]();!(i=(d=f.next()).done);i=!0){var m=d.value;a.set(m.functionId,m)}}catch(x){o=!0,l=x}finally{try{i||null==f.return||f.return()}finally{if(o)throw l}}r=function(e,t){return _(e,new N,new N(t))}(t.program.mainDefinition,a)}catch(O){if(!(O instanceof k))throw O;console.log("COMPILATION ERROR",O.message)}if(e){var p=e.liveMain,v=p.context,h=p.updateCompiledDefinition;Object(A.beginBatch)(),h(r),Object(A.endBatch)(),n={context:v,updateCompiledDefinition:h,compiledDefinition:r}}else{var E=function e(t,n,r){var a=new Set,i=t;return[function(){var t=Object(A.useRequestUpdate)(),o=Object(A.useVar)(function(){var a=new N(n),o=new N(r),u=!0,l=!1,s=void 0;try{for(var d,f=i.literalStreamValues[Symbol.iterator]();!(u=(d=f.next()).done);u=!0){var m=d.value,p=Object(c.a)(m,2),v=p[0],h=p[1];a.set(v,h)}}catch(x){l=!0,s=x}finally{try{u||null==f.return||f.return()}finally{if(l)throw s}}var E=new Map,g=!0,b=!1,y=void 0;try{for(var w,O=i.applications[Symbol.iterator]();!(g=(w=O.next()).done);g=!0){var S=w.value,I=Object(c.a)(S,2),j=I[0],T=I[1],k=o.get(T);if(!k)throw console.log(T),Error();E.set(j,new A.ExecutionContext(k,t))}}catch(x){b=!0,y=x}finally{try{g||null==O.return||O.return()}finally{if(b)throw y}}var C=new Map,_=!0,D=!1,R=void 0;try{for(var P,M=i.containedDefinitions[Symbol.iterator]();!(_=(P=M.next()).done);_=!0){var U=P.value,L=Object(c.a)(U,2),F=L[0],V=e(L[1],a,o),q=Object(c.a)(V,2),G=q[0],H=q[1];o.set(F,G),C.set(F,H)}}catch(x){D=!0,R=x}finally{try{_||null==M.return||M.return()}finally{if(D)throw R}}return{streamEnvironment:a,functionEnvironment:o,applicationContext:E,updateContainedDefinition:C,requestUpdate:t}});Object(A.useInitialize)(function(){return a.add(o.current),function(){o.current.applicationContext.forEach(function(e){e.terminate()}),a.delete(o.current)}});var l=o.current,s=l.streamEnvironment,d=l.functionEnvironment,f=l.applicationContext;if(arguments.length!==i.parameterStreams.length)throw new Error("wrong number of arguments to live function, got "+arguments.length+" expected "+i.parameterStreams.length);var m=0,p=!0,v=!1,h=void 0;try{for(var E,g=i.parameterStreams[Symbol.iterator]();!(p=(E=g.next()).done);p=!0){var b=E.value;s.set(b,arguments[m]),m++}}catch(x){v=!0,h=x}finally{try{p||null==g.return||g.return()}finally{if(v)throw h}}var y=!0,w=!1,S=void 0;try{for(var I,j=i.applications[Symbol.iterator]();!(y=(I=j.next()).done);y=!0){var T=I.value,k=Object(c.a)(T,4),C=k[0],_=k[2],D=k[3],R=[].concat(Object(u.a)(_.map(function(e){return s.get(e)})),Object(u.a)(D.map(function(e){return d.get(e)}))),P=f.get(C);if(!P)throw new Error;var M=void 0;try{M=P.update.apply(P,Object(u.a)(R))}catch(O){console.log("application error")}s.set(C,M)}}catch(x){w=!0,S=x}finally{try{y||null==j.return||j.return()}finally{if(w)throw S}}return i.yieldStream?s.get(i.yieldStream):void 0},function(t){if(JSON.stringify(t)!==JSON.stringify(i)){var n=new Map,r=new Map,o=!0,u=!1,l=void 0;try{for(var s,d=i.literalStreamValues[Symbol.iterator]();!(o=(s=d.next()).done);o=!0){var f=s.value,m=Object(c.a)(f,2),p=m[0],v=m[1];n.set(p,v)}}catch(x){u=!0,l=x}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}var h=!0,E=!1,g=void 0;try{for(var b,y=t.literalStreamValues[Symbol.iterator]();!(h=(b=y.next()).done);h=!0){var w=b.value,O=Object(c.a)(w,2),S=O[0],I=O[1];r.set(S,I)}}catch(x){E=!0,g=x}finally{try{h||null==y.return||y.return()}finally{if(E)throw g}}var j=!0,N=!1,T=void 0;try{for(var k,C=function(){var e=k.value,t=Object(c.a)(e,1)[0];r.has(t)||a.forEach(function(e){e.streamEnvironment.delete(t)})},_=i.literalStreamValues[Symbol.iterator]();!(j=(k=_.next()).done);j=!0)C()}catch(x){N=!0,T=x}finally{try{j||null==_.return||_.return()}finally{if(N)throw T}}var D=!0,R=!1,P=void 0;try{for(var M,U=function(){var e=M.value,t=(F=Object(c.a)(e,2))[0],r=F[1];n.has(t)&&n.get(t)===r||a.forEach(function(e){e.streamEnvironment.set(t,r)})},L=t.literalStreamValues[Symbol.iterator]();!(D=(M=L.next()).done);D=!0){var F;U()}}catch(x){R=!0,P=x}finally{try{D||null==L.return||L.return()}finally{if(R)throw P}}var V=new Map,q=new Map,G=!0,H=!1,B=void 0;try{for(var W,z=i.applications[Symbol.iterator]();!(G=(W=z.next()).done);G=!0){var J=W.value,K=Object(c.a)(J,3),Z=K[0],X=K[1],Y=K[2];V.set(Z,[X,Y])}}catch(x){H=!0,B=x}finally{try{G||null==z.return||z.return()}finally{if(H)throw B}}var $=!0,Q=!1,ee=void 0;try{for(var te,ne=t.applications[Symbol.iterator]();!($=(te=ne.next()).done);$=!0){var re=te.value,ae=Object(c.a)(re,3),ie=ae[0],oe=ae[1],ue=ae[2];q.set(ie,[oe,ue])}}catch(x){Q=!0,ee=x}finally{try{$||null==ne.return||ne.return()}finally{if(Q)throw ee}}var ce=!0,le=!1,se=void 0;try{for(var de,fe=function(){var e=de.value,t=Object(c.a)(e,2)[0];q.has(t)||a.forEach(function(e){e.applicationContext.get(t).terminate()})},me=i.applications[Symbol.iterator]();!(ce=(de=me.next()).done);ce=!0)fe()}catch(x){le=!0,se=x}finally{try{ce||null==me.return||me.return()}finally{if(le)throw se}}var pe=!0,ve=!1,he=void 0;try{for(var Ee,ge=function(){var e=Ee.value,t=(ye=Object(c.a)(e,3))[0],n=ye[1],r=ye[2],i=!1,o=V.get(t);if(o){var u=Object(c.a)(o,2),l=u[0],s=u[1];n===l&&function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(r,s)||(a.forEach(function(e){e.applicationContext.get(t).terminate()}),i=!0)}else i=!0;i&&a.forEach(function(e){var r=e.functionEnvironment.get(n);if(!r)throw Error();e.applicationContext.set(t,new A.ExecutionContext(r,e.requestUpdate))})},be=t.applications[Symbol.iterator]();!(pe=(Ee=be.next()).done);pe=!0){var ye;ge()}}catch(x){ve=!0,he=x}finally{try{pe||null==be.return||be.return()}finally{if(ve)throw he}}var we=new Map,xe=new Map,Oe=!0,Se=!1,Ie=void 0;try{for(var je,Ne=i.containedDefinitions[Symbol.iterator]();!(Oe=(je=Ne.next()).done);Oe=!0){var Te=je.value,ke=Object(c.a)(Te,2),Ce=ke[0],_e=ke[1];we.set(Ce,_e)}}catch(x){Se=!0,Ie=x}finally{try{Oe||null==Ne.return||Ne.return()}finally{if(Se)throw Ie}}var Ae=!0,De=!1,Re=void 0;try{for(var Pe,Me=t.containedDefinitions[Symbol.iterator]();!(Ae=(Pe=Me.next()).done);Ae=!0){var Ue=Pe.value,Le=Object(c.a)(Ue,2),Fe=Le[0],Ve=Le[1];xe.set(Fe,Ve)}}catch(x){De=!0,Re=x}finally{try{Ae||null==Me.return||Me.return()}finally{if(De)throw Re}}var qe=!0,Ge=!1,He=void 0;try{for(var Be,We=function(){var e=Be.value,t=Object(c.a)(e,1)[0];xe.has(t)||a.forEach(function(e){e.functionEnvironment.delete(t),e.updateContainedDefinition.delete(t)})},ze=i.containedDefinitions[Symbol.iterator]();!(qe=(Be=ze.next()).done);qe=!0)We()}catch(x){Ge=!0,He=x}finally{try{qe||null==ze.return||ze.return()}finally{if(Ge)throw He}}var Je=!0,Ke=!1,Ze=void 0;try{for(var Xe,Ye=function(){var t=Xe.value,n=(Qe=Object(c.a)(t,2))[0],r=Qe[1];we.has(n)?a.forEach(function(e){e.updateContainedDefinition.get(n)(r)}):a.forEach(function(t){var a=e(r,t.streamEnvironment,t.functionEnvironment),i=Object(c.a)(a,2),o=i[0],u=i[1];t.functionEnvironment.set(n,o),t.updateContainedDefinition.set(n,u)})},$e=t.containedDefinitions[Symbol.iterator]();!(Je=(Xe=$e.next()).done);Je=!0){var Qe;Ye()}}catch(x){Ke=!0,Ze=x}finally{try{Je||null==$e.return||$e.return()}finally{if(Ke)throw Ze}}i=t,a.forEach(function(e){e.requestUpdate()})}}]}(r,new N,ce),g=Object(c.a)(E,2),b=g[0],y=g[1],w=Object(A.createNullaryVoidRootExecutionContext)(b);w.update(),n={context:w,updateCompiledDefinition:y,compiledDefinition:r}}return Object(s.a)({},t,{liveMain:n})}function oe(e,t){var n,r=function(e){var t=T(e.program,{},function(t){return"StreamReference"===t.type?[!1,e.derivedLookups.streamIdToNode.has(t.targetStreamId)?t:{type:"UndefinedExpression",streamId:y(),identifier:t.identifier}]:[!1,t]});return t===e.program?e:Object(s.a)({},e,{program:t})}(re(t));return ie(e,(n=re(r),Object(s.a)({},n,{derivedLookups:Object(s.a)({},n.derivedLookups,{nodeToPath:ae(n.program)})})))}function ue(e,t){if("LOAD_PROGRAM"===t.type){if(!t.program)throw new Error;if(!e.liveMain)throw new Error;return e.liveMain.context.terminate(),le(t.program)}var n=e.program,r=e.selectionPath,a=e.editingSelected,i=e.undoStack,o=e.clipboardStack;if(["EDIT_NEXT_UNDEFINED","EDIT_AFTER","BEGIN_IDENTIFIER_EDIT"].includes(t.type)){var l=ne(n,r,a,{type:"CONFIRM_EDIT"}),d=Object(c.a)(l,3);n=d[0],r=d[1],a=d[2]}if("UNDO"===t.type){if(e.undoStack.length>0){var f=i[i.length-1];n=f.program,r=f.selectionPath,i=i.slice(0,i.length-1)}}else if("CUT"===t.type){var m=J(n,r);if(v(m)){o=o.concat([{mode:"cut",streamId:m.streamId}]);var p=function(e,t){var n,r,a=T(e,{alongPath:t},function(e,a){if(Y(a,t)){if(!v(e))throw new Error;if(n)throw new Error;return n=e,[!1,r={type:"UndefinedExpression",streamId:y(),identifier:null}]}if(h(e)&&n){var i=t.slice(a.length);if(i.length<2||"expressions"!==i[0])throw new Error;var o=i[1];if("number"!==typeof o)throw new Error;var c=Object(s.a)({},e,{expressions:[].concat(Object(u.a)(e.expressions.slice(0,o)),[n],Object(u.a)(e.expressions.slice(o)))});return n=void 0,[!1,c]}return[!1,e]});if("Program"!==a.type)throw new Error;if(!r)throw new Error;var i=ae(a).get(r);if(!i)throw new Error;return[a,i]}(n,r),E=Object(c.a)(p,2);n=E[0],r=E[1]}}else if("PASTE"===t.type){var g=J(n,r);if(o.length>0&&v(g)){var b=o[o.length-1];o=o.slice(0,o.length-1);var w=function(e,t,n,r){var a=T(n,{},function(n,a){if(Y(a,r)){if(!v(n))throw new Error;return[!1,e]}var i;if(h(n)&&(n.expressions.forEach(function(e,n){e.streamId===t&&(i=n)}),void 0!==i)){var o=$(n,i);return[!1,Object(c.a)(o,2)[0]]}return[!1,n]});if("Program"!==a.type)throw new Error;var i=ae(a).get(e);if(!i)throw new Error;return[a,i]}(e.derivedLookups.streamIdToNode.get(b.streamId),b.streamId,n,r),x=Object(c.a)(w,2);n=x[0],r=x[1]}}else if("SET_PATH"===t.type){var O=J(n,r=t.newPath);a="Identifier"===O.type?{originalNode:O,tentativeNode:O}:null}else if("EDIT_NEXT_UNDEFINED"===t.type){var S=ee(n,r);if(S){var I=Object(c.a)(S,2),j=I[0];r=I[1],a={originalNode:j,tentativeNode:j}}else a=null}else{var N=ne(n,r,a,t),k=Object(c.a)(N,3);n=k[0],r=k[1],a=k[2]}return n!==e.program||r!==e.selectionPath||a!==e.editingSelected||i!==e.undoStack||o!==e.clipboardStack?(n!==e.program&&(console.log("program changed identity"),"UNDO"!==t.type&&(i=i.concat([{program:e.program,selectionPath:e.selectionPath}]))),oe(e,{program:n,selectionPath:r,editingSelected:a,nativeFunctions:e.nativeFunctions,derivedLookups:{streamIdToNode:null,functionIdToNode:null,nodeToPath:null},liveMain:null,undoStack:i,clipboardStack:o})):e}var ce=new N;function le(e){return oe(void 0,{program:e,selectionPath:["mainDefinition"],editingSelected:null,nativeFunctions:W.map(function(e){var t=Object(c.a)(e,4);return{type:"NativeFunction",functionId:t[0],identifier:{type:"Identifier",name:t[1]},signature:{parameters:t[2],functionParameters:t[3]}}}),derivedLookups:{streamIdToNode:null,functionIdToNode:null,nodeToPath:null},liveMain:null,undoStack:[],clipboardStack:[]})}ce.set("id",function(e){return e}),ce.set("Array_of",Array.of),W.forEach(function(e){var t=Object(c.a)(e,5),n=t[0],r=t[4];ce.set(n,r)});var se=y(),de=le({type:"Program",id:y(),name:"my program",mainDefinition:{type:"UserFunction",functionId:y(),identifier:null,signature:{parameters:[],functionParameters:[]},parameters:[],functionParameterFunctionIds:[],expressions:[{type:"Application",streamId:se,identifier:{type:"Identifier",name:"md"},functionId:"mouseDown",arguments:[],functionArguments:[]},{type:"Application",streamId:y(),identifier:null,functionId:"showString",arguments:[{type:"Application",streamId:y(),identifier:null,functionId:"ifte",arguments:[{type:"StreamReference",streamId:y(),identifier:null,targetStreamId:se},{type:"IntegerLiteral",streamId:y(),identifier:null,value:10},{type:"IntegerLiteral",streamId:y(),identifier:null,value:20}],functionArguments:[]}],functionArguments:[]}]}});n(36);function fe(e,t){for(var n=0,r=0,a=e.length,i=0,o=t.length,u=!1,c=!1,l=!0,s=null,d=null,f=null,m=0,p=[];i!==o;){var v=r!==a?e.charAt(r):null,h=t.charAt(i),E=null!==v?v.toLowerCase():null,g=h.toLowerCase(),b=h.toUpperCase(),y=v&&E===g,w=s&&d===g;if((y&&s||s&&v&&d===E)&&(n+=m,p.push(f),s=null,d=null,f=null,m=0),y||w){var x=0;if(0===r)n+=Math.max(-3*i,-9);u&&(x+=5),l&&(x+=10),c&&h===b&&g!==b&&(x+=10),y&&++r,x>=m&&(null!==s&&(n+=-1),d=(s=h).toLowerCase(),f=i,m=x),u=!0}else n+=-1,u=!1;c=h===g&&g!==b,l="_"===h||" "===h,++i}s&&(n+=m,p.push(f));for(var O="",S=0,I=0;I<p.length;++I){var j=p[I];O+=t.substr(S,j-S)+"<b>"+t.charAt(j)+"</b>",S=j+1}return[r===a,n,O+=t.substr(S,t.length-S)]}function me(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var l=o.value,s=Object(c.a)(l,2),d=s[0],f=s[1],m=fe(e,d),p=Object(c.a)(m,3),v=p[0],h=p[1],E=p[2];v&&n.push({score:h,formattedStr:E,name:d,data:f})}}catch(g){a=!0,i=g}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return""!==e&&n.sort(function(e,t){return t.score-e.score}),n}var pe=/^[-+]?(?:\d*\.?\d+|\d+\.?\d*)(?:[eE][-+]?\d+)?$/;function ve(e,t){var n=[];""===e&&n.push({type:"undefined"});var r=X(t),a=r.namedStreams,i=r.namedFunctions,o=me(e,a),u=!0,c=!1,l=void 0;try{for(var s,d=o[Symbol.iterator]();!(u=(s=d.next()).done);u=!0){var f=s.value;n.push({type:"streamref",node:f.data})}}catch(y){c=!0,l=y}finally{try{u||null==d.return||d.return()}finally{if(c)throw l}}var m=me(e,i),p=!0,v=!1,h=void 0;try{for(var E,g=m[Symbol.iterator]();!(p=(E=g.next()).done);p=!0){var b=E.value;n.push({type:"function",node:b.data})}}catch(y){v=!0,h=y}finally{try{p||null==g.return||g.return()}finally{if(v)throw h}}return pe.test(e)&&n.push({type:"number",value:Number(e)}),0===n.length&&n.push({type:"undefined"}),n}function he(e){var t=e.choice;switch(t.type){case"undefined":return a.a.createElement("em",null,"undefined");case"number":return a.a.createElement("span",null,t.value);case"streamref":return a.a.createElement("span",null,a.a.createElement("em",null,"S")," ",t.node.identifier.name," ",a.a.createElement("small",null,"(id ",t.node.streamId,")"));case"function":return a.a.createElement("span",null,a.a.createElement("em",null,"F")," ",t.node.identifier.name,"(",[].concat([t.node.signature.parameters.map(function(e){return e.startsWith("_")?"\u25a1":e}),t.node.signature.functionParameters.map(function(e){var t=Object(c.a)(e,1)[0];return"F "+(t.startsWith("_")?"\u25a1":t)})]).join(", "),")");default:throw new Error}}function Ee(e){e.node;var t=e.mainState,n=e.dispatch,i=Object(r.useRef)();Object(r.useEffect)(function(){i.current&&i.current.scrollIntoView({block:"nearest",inline:"nearest"})});var o=Object(r.useState)(function(){var e=t.editingSelected.tentativeNode;switch(e.type){case"UndefinedExpression":return"";case"IntegerLiteral":return e.value.toString();case"StreamReference":case"Application":return"";default:throw new Error}}),u=Object(c.a)(o,2),l=u[0],d=u[1],f=function(e){var r,a=e.choices[e.index];switch(a.type){case"undefined":r={type:"UndefinedExpression"};break;case"number":r={type:"IntegerLiteral",value:a.value};break;case"streamref":r={type:"StreamReference",targetStreamId:a.node.streamId};break;case"function":r={type:"Application",functionId:a.node.functionId,arguments:a.node.signature.parameters.map(function(e){return{type:"UndefinedExpression",streamId:y(),identifier:null}}),functionArguments:a.node.signature.functionParameters.map(function(e){var t=Object(c.a)(e,2)[1];return{type:"UserFunction",functionId:y(),identifier:null,signature:t,parameters:t.parameters.map(function(e){return{type:"Parameter",streamId:y(),identifier:{type:"Identifier",name:e}}}),functionParameterFunctionIds:t.functionParameters.map(function(e){var t=Object(c.a)(e,2);t[0],t[1];return y()}),expressions:[{type:"UndefinedExpression",streamId:y(),identifier:null}]}})};break;default:throw new Error}r.streamId=t.editingSelected.tentativeNode.streamId,r.identifier=t.editingSelected.tentativeNode.identifier,n({type:"UPDATE_EDITING_TENTATIVE_NODE",newNode:r})},m=function(e){var n={choices:ve(e,t),index:0};return f(n),n},p=function(e){g(function(t){var n=Object(s.a)({},t,{index:(t.index+e+t.choices.length)%t.choices.length});return f(n),n})},v=Object(r.useState)(function(){return m(l)}),h=Object(c.a)(v,2),E=h[0],g=h[1];return a.a.createElement("div",null,a.a.createElement("input",{className:"Editor-text-edit-input",value:l,onChange:function(e){var t=e.target.value;"["===t?(n({type:"END_EXPRESSION_EDIT"}),n({type:"CREATE_ARRAY"})):(d(t),g(m(t)))},onKeyDown:function(e){switch(e.key){case"ArrowUp":e.preventDefault(),p(-1);break;case"ArrowDown":e.preventDefault(),p(1)}},autoFocus:!0}),a.a.createElement("ul",{className:"ExpressionChooser-dropdown"},E.choices.map(function(e,t){return a.a.createElement("li",{key:t,className:t===E.index?"ExpressionChooser-dropdown-selected":"",ref:t===E.index?i:void 0},a.a.createElement(he,{choice:e}))})))}n(37);function ge(e){var t=e.currentProgram,n=e.onChangeName,i=e.onLoadProgram,o=window.localStorage,u=Object(r.useState)(),l=Object(c.a)(u,2),d=l[0],f=l[1],m=Object(r.useState)([]),p=Object(c.a)(m,2),v=p[0],h=p[1],E=function(e){for(var t=void 0===e?d:e,n=[],r=0;r<o.length;r++){var a=o.key(r);if(a.startsWith("rivprog:")){var i=JSON.parse(o.getItem(a));n.push(i)}}h(n),n.map(function(e){return e.id}).includes(t)||(t=void 0),f(t)};Object(r.useEffect)(function(){E()},[]);var g=Object(r.useRef)();return a.a.createElement("div",{className:"StoragePanel"},a.a.createElement("div",null,a.a.createElement("span",null,"Current Program:")," ",a.a.createElement("label",null,"UID: ",a.a.createElement("span",null,t.id))," ",a.a.createElement("label",null,"Name: ",a.a.createElement("input",{value:t.name,onChange:function(e){n&&n(e.target.value)}}))," ",a.a.createElement("button",{onClick:function(){var e="rivprog:"+t.id,n=JSON.stringify(t);o.setItem(e,n),E(t.id)}},"Save")," ",a.a.createElement("button",{onClick:function(){i(Object(s.a)({},t,{id:y()}))}},"Clone")," ",a.a.createElement("button",{disabled:!0},"Import")," ",a.a.createElement("button",{disabled:!0},"Export")," "),a.a.createElement("div",null,a.a.createElement("span",null,"Saved Programs:")," ",a.a.createElement("select",{ref:g,value:d,onChange:function(e){f(e.target.value)}},v.map(function(e){return a.a.createElement("option",{key:e.id,value:e.id},e.name," <",e.id,">")}))," ",a.a.createElement("button",{onClick:function(){if(g.current&&g.current.value){var e="rivprog:"+g.current.value,t=JSON.parse(o.getItem(e));i(t)}},disabled:0===v.length},"Load")," ",a.a.createElement("button",{onClick:function(){if(g.current&&g.current.value){var e="rivprog:"+g.current.value;o.removeItem(e),E()}},disabled:0===v.length},"Delete")," "))}n(38);function be(e){var t=e.marks,n=e.onSelect,i=e.onEdit,o=e.children,u=e.extraClassName,l=Object(r.useState)(!1),s=Object(c.a)(l,2),d=s[0],f=s[1],m=u||"";m+=" SimpleTheme-selectable",t.includes("selected")?m+=" SimpleTheme-selected":d?m+=" SimpleTheme-hovered":t.includes("clipboard-top")?m+=" SimpleTheme-clipboard-top":t.includes("clipboard-rest")&&(m+=" SimpleTheme-clipboard-rest");return a.a.createElement("div",{className:m,onClick:function(e){n&&"INPUT"!==e.target.tagName&&(e.stopPropagation(),n())},onDoubleClick:function(e){i&&"INPUT"!==e.target.tagName&&(e.stopPropagation(),i())},onMouseOver:function(e){f(!0),e.stopPropagation()},onMouseOut:function(e){f(!1)}},o)}var ye=function(e){var t=e.expressionGrouping,n=e.applicationArguments;return{Application:function(e){var t=e.functionName,r=e.streamArgs,i=e.functionArgs,o="right"===n||"right-centered"===n?"SimpleTheme-application-flex":"",u="SimpleTheme-application-function-name"+("right-centered"===n?" SimpleTheme-application-function-name-centered":"");return a.a.createElement("div",{className:o},a.a.createElement("div",{className:u},t),a.a.createElement("div",{className:"SimpleTheme-application-arguments"},r.map(function(e){var t=e.key,n=e.name,r=e.expression;return a.a.createElement("div",{className:"SimpleTheme-application-argument",key:t},n?a.a.createElement("span",{className:"SimpleTheme-application-argument-name"},n,":"):null,a.a.createElement("span",{className:"SimpleTheme-application-argument-expression"},r))}),i.map(function(e){var t=e.key,n=(e.name,e.functionExpression);return a.a.createElement("div",{className:"SimpleTheme-application-argument",key:t},n)})))},UserFunction:function(e){var t=e.parameterNames,n=e.expressions,r=e.marks,i=e.onSelect;return a.a.createElement(be,{marks:r,onSelect:i,extraClassName:"SimpleTheme-user-function"},a.a.createElement("div",null,"\u0192 ",t.join(", ")),a.a.createElement("div",{className:"SimpleTheme-user-function-expressions"},n))},DefinitionExpression:function(e){var t=e.expression;return a.a.createElement("div",{className:"SimpleTheme-definition-expression"},t)},Expression:function(e){var n=e.identifier,r=e.marks,i=e.onSelect,o=e.onEdit,u=e.inside,c="SimpleTheme-expression";switch(t){case"background":c+=" SimpleTheme-expression-background";break;case"shadow":c+=" SimpleTheme-expression-shadow"}return a.a.createElement(be,{marks:r,onSelect:i,onEdit:o,extraClassName:c},function(){switch(t){case"line":return a.a.createElement("div",{className:"SimpleTheme-expression-line"});case"bracket":return a.a.createElement("div",{className:"SimpleTheme-expression-bracket"});default:return null}}(),a.a.createElement("div",null,n?a.a.createElement("div",{className:"SimpleTheme-expression-identifier"},n):null,a.a.createElement("div",{className:"SimpleTheme-expression-main"},u)))},Identifier:function(e){var t=e.marks,n=e.onSelect,r=e.inside;return a.a.createElement(be,{marks:t,onSelect:n,extraClassName:"SimpleTheme-identifier"},r)},StreamReference:function(e){var t=e.name;return a.a.createElement("div",null,a.a.createElement("span",{className:"SimpleTheme-stream-reference"},t))},UndefinedExpression:function(){return a.a.createElement("div",{className:"SimpleTheme-undefined-expression"},"\xa0")},ArrayLiteral:function(e){var t=e.keyedItems;return a.a.createElement("div",null,a.a.createElement("div",null,"["),a.a.createElement("div",{className:"SimpleTheme-array-items"},t.map(function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return a.a.createElement("div",{className:"SimpleTheme-array-item",key:n},r)})),a.a.createElement("div",null,"]"))}}},we=(n(39),{expressionGrouping:"background",applicationArguments:"right"}),xe=ye(we);function Oe(e){var t=e.keyLabels,n=e.selectedKey,r=e.onChange;return a.a.createElement("select",{value:n,onChange:function(e){r(e.target.value)}},t.map(function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return a.a.createElement("option",{key:n,value:n},r)}))}function Se(e){var t=e.onChange,n=Object(r.useState)(we),i=Object(c.a)(n,2),o=i[0],u=i[1],l=function(e){u(e),t(ye(e))};return a.a.createElement("div",{className:"ThemePicker"},a.a.createElement("div",{className:"ThemePicker-option"},a.a.createElement("label",null,"Expression Grouping: ",a.a.createElement(Oe,{keyLabels:[["none","None"],["line","Line"],["bracket","Bracket"],["background","Background"],["shadow","Shadow"]],selectedKey:o.expressionGrouping,onChange:function(e){return l(Object(s.a)({},o,{expressionGrouping:e}))}}))),a.a.createElement("div",{className:"ThemePicker-option"},a.a.createElement("label",null,"Application Arguments: ",a.a.createElement(Oe,{keyLabels:[["below","Below"],["right","Right"],["right-centered","Right (centered)"]],selectedKey:o.applicationArguments,onChange:function(e){return l(Object(s.a)({},o,{applicationArguments:e}))}}))))}n(40);var Ie={MOVE_UP:"up",MOVE_DOWN:"down",MOVE_LEFT:"left",MOVE_RIGHT:"right",ZOOM_IN:"shift+right",ZOOM_OUT:"shift+left",TOGGLE_EDIT:"enter",ABORT_EDIT:"escape",EDIT_AFTER:["shift+enter",","],DELETE:"backspace",BEGIN_IDENTIFIER_EDIT:"=",EDIT_NEXT_UNDEFINED:"tab",UNDO:"command+z",CUT:"command+x",PASTE:"command+v"},je=new Set(["=",","]),Ne=["Enter","Shift","Escape","Tab","=",","],Te=Object(r.createContext)(),ke=Object(r.createContext)(),Ce=Object(r.createContext)();function _e(e){var t=[],n=Object(r.useContext)(Ce),a=n.selectedNode,i=n.clipboardTopNode,o=n.clipboardRestNodes;return e===a&&t.push("selected"),e===i&&t.push("clipboard-top"),o.includes(e)&&t.push("clipboard-rest"),t}function Ae(e){var t=Object(r.useContext)(ke),n=Object(r.useContext)(Te);return function(){var r=n.derivedLookups.nodeToPath.get(e);r&&t({type:"SET_PATH",newPath:r})}}var De=Object(r.createContext)();function Re(e){var t=e.expressions,n=Object(r.useContext)(De).DefinitionExpression;return a.a.createElement(a.a.Fragment,null,t.map(function(e){return a.a.createElement("div",{key:e.streamId},a.a.createElement(n,{expression:a.a.createElement(Be,{expression:e})}))}))}function Pe(e){var t=e.initialName,n=e.onUpdateName,i=(e.onEndEdit,Object(r.useState)(t||"")),o=Object(c.a)(i,2),u=o[0],l=o[1];return a.a.createElement("input",{className:"Editor-text-edit-input",value:u,onChange:function(e){var t=e.target.value;l(t),n&&n(t)},autoFocus:!0})}function Me(e){var t=e.identifier,n=_e(t),i=Ae(t),o=Object(r.useContext)(Te).editingSelected,u=Object(r.useContext)(ke),c=Object(r.useContext)(De).Identifier;return a.a.createElement(c,{marks:n,onSelect:i,inside:n.includes("selected")&&o?a.a.createElement(Pe,{initialName:t.name,onUpdateName:function(e){u({type:"UPDATE_EDITING_TENTATIVE_NODE",newNode:{type:"Identifier",name:e}})}}):t.name})}function Ue(e){var t=e.integerLiteral;return a.a.createElement("div",null,t.value)}function Le(e){var t=e.arrayLiteral,n=Object(r.useContext)(De).ArrayLiteral;return a.a.createElement(n,{keyedItems:t.items.map(function(e){return[e.streamId,a.a.createElement(Be,{expression:e})]})})}function Fe(e){e.undefinedExpression;var t=Object(r.useContext)(De).UndefinedExpression;return a.a.createElement(t,null)}function Ve(e){var t=e.streamReference,n=Object(r.useContext)(Te).derivedLookups.streamIdToNode.get(t.targetStreamId);if(!n)throw new Error;var i=Object(r.useContext)(De).StreamReference;return a.a.createElement(i,{name:n.identifier&&n.identifier.name?n.identifier.name:"<stream "+t.targetStreamId+">"})}function qe(e){var t=e.userFunction,n=_e(t),i=Ae(t),o=Object(r.useContext)(De).UserFunction;return a.a.createElement(o,{parameterNames:t.parameters.map(function(e){return e.identifier.name}),expressions:a.a.createElement(Re,{expressions:t.expressions}),marks:n,onSelect:i})}function Ge(e){var t=e.application,n=Object(r.useContext)(Te).derivedLookups.functionIdToNode.get(t.functionId);if(!n)throw new Error;if(n.signature.parameters.length!==t.arguments.length)throw new Error("params and args length mismatch");if(n.signature.functionParameters.length!==t.functionArguments.length)throw new Error("function params and args length mismatch");var i=n.identifier&&n.identifier.name?n.identifier.name:"<function "+t.functionId+">",o=n.signature.parameters.map(function(e,n){return{key:e,name:e.startsWith("_")?void 0:e,expression:a.a.createElement(Be,{expression:t.arguments[n]})}}),u=n.signature.functionParameters.map(function(e,n){var r=Object(c.a)(e,2),i=r[0];r[1];return{key:i,name:"dunno",functionExpression:a.a.createElement(qe,{userFunction:t.functionArguments[n]})}}),l=Object(r.useContext)(De).Application;return a.a.createElement(l,{functionName:i,streamArgs:o,functionArgs:u})}function He(e){var t=e.expression;switch(t.type){case"IntegerLiteral":return a.a.createElement(Ue,{integerLiteral:t});case"ArrayLiteral":return a.a.createElement(Le,{arrayLiteral:t});case"UndefinedExpression":return a.a.createElement(Fe,{undefinedExpression:t});case"StreamReference":return a.a.createElement(Ve,{streamReference:t});case"Application":return a.a.createElement(Ge,{application:t});default:throw new Error}}function Be(e){var t=e.expression,n=_e(t),i=Ae(t),o=function(e){var t=Object(r.useContext)(ke),n=Object(r.useContext)(Te);return function(){var r=n.derivedLookups.nodeToPath.get(e);r&&(t({type:"SET_PATH",newPath:r}),t({type:"TOGGLE_EDIT"}))}}(t),u=Object(r.useContext)(Te),c=u.editingSelected,l=Object(r.useContext)(ke),s=Object(r.useContext)(De).Expression;return a.a.createElement(s,{identifier:t.identifier?a.a.createElement(Me,{identifier:t.identifier}):null,marks:n,onSelect:i,onEdit:o,inside:n.includes("selected")&&c?a.a.createElement(Ee,{node:t,mainState:u,dispatch:l}):a.a.createElement(He,{expression:t})})}function We(e){var t=e.autoFocus,n=Object(r.useReducer)(ue,de),i=Object(c.a)(n,2),o=i[0],s=i[1],d=Object(r.useState)(xe),f=Object(c.a)(d,2),m=f[0],p=f[1],v=Object(r.useRef)(),h=Object(r.useState)(t),E=Object(c.a)(h,1)[0];Object(r.useEffect)(function(){E&&v.current.focus()},[E]);var g=Object(r.useRef)(!1);Object(r.useEffect)(function(){g.current&&!o.editingSelected&&v.current.focus(),g.current=o.editingSelected});for(var b={},y=function(){var e=x[w];b[e]=function(t){t.preventDefault(),s({type:e})}},w=0,x=Object.keys(Ie);w<x.length;w++)y();var O={selectedNode:J(o.program,o.selectionPath),clipboardTopNode:o.clipboardStack.length>0?o.derivedLookups.streamIdToNode.get(o.clipboardStack[o.clipboardStack.length-1].streamId):null,clipboardRestNodes:o.clipboardStack.slice(0,-1).map(function(e){return o.derivedLookups.streamIdToNode.get(e.streamId)})};return a.a.createElement("div",{className:"Editor"},a.a.createElement(l.HotKeys,{keyMap:Ie,handlers:b},a.a.createElement(l.ObserveKeys,{only:Ne},a.a.createElement("div",{className:"Editor-workspace",onKeyDown:function(e){"input"===e.target.tagName.toLowerCase()||1!==Object(u.a)(e.key).length||e.altkey||e.ctrlKey||e.metaKey||je.has(e.key)||s({type:"BEGIN_OVERWRITE_EDIT"})},tabIndex:"0",ref:v},a.a.createElement("div",{className:"Editor-theme-controls"},a.a.createElement(Se,{onChange:function(e){p(e)}})),a.a.createElement(ke.Provider,{value:s},a.a.createElement(Ce.Provider,{value:O},a.a.createElement(Te.Provider,{value:o},a.a.createElement(De.Provider,{value:m},a.a.createElement(qe,{userFunction:o.program.mainDefinition})))))))),a.a.createElement("div",{className:"Editor-storage-panel-container"},a.a.createElement(ge,{currentProgram:o.program,onChangeName:function(e){s({type:"SET_PROGRAM_NAME",newName:e})},onLoadProgram:function(e){s({type:"LOAD_PROGRAM",program:e})}})))}var ze=function(){return a.a.createElement("div",{className:"App"},a.a.createElement(We,{autoFocus:!0}),a.a.createElement("div",null,a.a.createElement("h2",null,"Notes"),a.a.createElement("ul",null,a.a.createElement("li",null,"If you don't see a green selection/cursor box, focus the editor."),a.a.createElement("li",null,"The mouse can be used to select parts of the tree, but otherwise editing is keyboard-driven."),a.a.createElement("li",null,"Up/down arrows move selection up and down within lists (expressions, arguments, arrays)."),a.a.createElement("li",null,"Right/left arrows move selection in and out of nested structures."),a.a.createElement("li",null,"Enter on an expression (or expression sub-tree) will begin editing it. Pressing enter again will stop editing."),a.a.createElement("li",null,"Instead of pressing enter, you can just start typing letters/numbers and it will begin the edit (overwriting what it there)."),a.a.createElement("li",null,"Escape aborts the current edit."),a.a.createElement("li",null,"Shift-enter (or comma) adds a new expression (or array item) below the current one."),a.a.createElement("li",null,"Pressing the = key on on an expression will move to editing its name/label."),a.a.createElement("li",null,"A red box indicates an undefined expression."),a.a.createElement("li",null,"Tab edits the next undefined expression."),a.a.createElement("li",null,"Delete will delete expressions, array items, etc."),a.a.createElement("li",null,"Typing [ when editing an expression will create an array literal."))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(ze,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[16,1,2]]]);
//# sourceMappingURL=main.b1c31e5a.chunk.js.map